<div [class.blurred]="showLoginModal">
  <app-navbar></app-navbar>

  <!-- Main Container -->
  <div class="home-container">

    <!-- Ride Search Form -->
    <form (ngSubmit)="searchRides()" class="ride-form">
      <h2>Search Your Ride</h2>

      <!-- From Location Input with Suggestions -->
      <input type="text" [(ngModel)]="rideQuery.from" name="from" placeholder="From" (input)="filterLocations('from')"
        list="fromLocations" required />
      <datalist id="fromLocations">
        <option *ngFor="let loc of filteredFromLocations" [value]="loc"></option>
      </datalist>

      <!-- To Location Input with Suggestions -->
      <input type="text" [(ngModel)]="rideQuery.to" name="to" placeholder="To" (input)="filterLocations('to')"
        list="toLocations" required />
      <datalist id="toLocations">
        <option *ngFor="let loc of filteredToLocations" [value]="loc"></option>
      </datalist>

      <input type="date" [(ngModel)]="rideQuery.date" name="date" required />
      <input type="number" [(ngModel)]="rideQuery.passengers" name="passengers" min="1" placeholder="Passengers"
        required />

      <button type="submit">Search</button>
    </form>

    <!-- âœ… Search Results Section -->
    <div class="rides-list" *ngIf="rides.length > 0">
      <h3>Available Rides</h3>

      <div class="ride-cards">
        <div class="ride-card" *ngFor="let ride of rides">
          <div class="ride-header">
            <h4>{{ ride.from || ride.From || 'Unknown Source' }} â†’ {{ ride.to || ride.To || 'Unknown Destination' }}
            </h4>
          </div>

          <!-- Dynamically show all key-value pairs -->
          <div class="ride-body">
            <div *ngFor="let key of getRideKeys(ride)">
              <p><strong>{{ formatKey(key) }}:</strong> {{ ride[key] }}</p>
            </div>
            <div class="ride-footer">
              <button class="book-btn hover:scale-105 transition-all duration-200" (click)="bookRide(ride)">
                ğŸš— Book Now
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- ğŸ§© Booking Request Popup -->
<div class="booking-request-modal" *ngIf="incomingBooking">
  <div class="modal-content">
    <h3>ğŸš— New Booking Request</h3>
    <p><strong>Ride ID:</strong> {{ incomingBooking.rideId }}</p>
    <p><strong>User ID:</strong> {{ incomingBooking.userId }}</p>
    <p>Do you want to accept this booking?</p>

    <div class="modal-buttons">
      <button class="accept-btn" (click)="respondToBooking('Accepted')">âœ… Accept</button>
      <button class="reject-btn" (click)="respondToBooking('Rejected')">âŒ Reject</button>
    </div>
  </div>
</div>


    <!-- âŒ Error Message (if API error occurs) -->
    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>

    <!-- Features Section -->
    <div class="features-section">
      <h2>Why Choose RideGeleya?</h2>
      <div class="features-container">
        <div class="feature">
          âš¡
          <h3>Lightning Fast</h3>
          <p>Find and book rides instantly with just a few clicks.</p>
        </div>
        <div class="feature">
          âœ…
          <h3>100% Verified</h3>
          <p>All rides and users are verified for your safety.</p>
        </div>
        <div class="feature">
          ğŸ“
          <h3>Real-time Tracking</h3>
          <p>Track your ride live and share location with friends.</p>
        </div>
      </div>
    </div>
  </div>
</div>



<div class="modal-backdrop" *ngIf="showLoginModal">
  <div class="modal-content">
    <app-login (close)="closeLoginModal()"></app-login>
  </div>
</div>